{
  "critical_flow": {
    "trigger": "Teams message posted",
    "condition": "or(contains(toLower(triggerBody()?['body']?['content']), 'stat'),contains(toLower(triggerBody()?['body']?['content']), 'critical value'),contains(toLower(triggerBody()?['body']?['content']), 'emergency'))",
    "notion_action": {
      "method": "POST",
      "uri": "https://api.notion.com/v1/pages",
      "headers": {
        "Authorization": "Bearer YOUR_NOTION_TOKEN",
        "Content-Type": "application/json",
        "Notion-Version": "2022-06-28"
      },
      "body": {
        "parent": {
          "database_id": "YOUR_DATABASE_ID"
        },
        "properties": {
          "Alert ID": {
            "title": [
              {
                "text": {
                  "content": "@{concat('ALERT-', formatDateTime(utcNow(), 'yyyyMMdd-HHmmss'))}"
                }
              }
            ]
          },
          "Severity": {
            "select": {
              "name": "\ud83d\udd34 Critical"
            }
          },
          "Message": {
            "rich_text": [
              {
                "text": {
                  "content": "@{triggerBody()?['body']?['content']}"
                }
              }
            ]
          },
          "Status": {
            "select": {
              "name": "\ud83d\udfe5 Open"
            }
          },
          "Timestamp": {
            "date": {
              "start": "@{utcNow()}"
            }
          },
          "Follow-up Required": {
            "checkbox": true
          }
        }
      }
    },
    "teams_notification": {
      "type": "AdaptiveCard",
      "body": [
        {
          "type": "TextBlock",
          "text": "\ud83d\udea8 CRITICAL LAB ALERT",
          "weight": "bolder",
          "color": "attention"
        }
      ]
    }
  }
}